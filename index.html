<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
  .file-icons a { font-size: 24px; text-decoration: none; }
  .file-icons a:hover { opacity: 0.7; }
  small.text-muted { font-size: 0.8rem; }
</style>
</head>
<body class="p-4">

<h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</h2>
<hr>

<form id="reqForm" enctype="multipart/form-data">
  <input type="hidden" name="sheetId" value="19HF10SiHNtUyT9ikq5TriUJO6KkK_y7OTS12W-2Xmck">

  <div class="row g-3">

    <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà + E-mail -->
    <div class="col-md-3">
      <label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
      <input type="date" name="date" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">E-mail</label>
      <input type="email" name="email" class="form-control" required>
    </div>

    <!-- ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• + ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á -->
    <div class="col-md-3">
      <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" name="fullname" class="form-control" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
      <input type="text" name="position" class="form-control" required>
    </div>

    <!-- ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó + ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô -->
    <div class="col-md-3">
      <label class="form-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
      <select name="type" class="form-select" required>
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
        <option>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</option>
        <option>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</option>
        <option>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏™‡∏¥‡πà‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</option>
      </select>
    </div>
    <div class="col-md-3">
      <label class="form-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
      <select name="department" class="form-select" required>
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
        <option>‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</option>
        <option>‡∏á‡∏≤‡∏ô‡πÅ‡∏ú‡∏ô‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏™‡∏î‡∏∏</option>
        <option>‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á</option>
        <option>‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</option>
        <option>‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏á‡∏™‡∏µ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î</option>
        <option>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ò‡∏≤‡∏•‡∏±‡∏™‡∏ã‡∏µ‡πÄ‡∏°‡∏µ‡∏¢</option>
        <option>‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
        <option>‡∏á‡∏≤‡∏ô‡πÄ‡∏ß‡∏ä‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</option>
        <option>‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏Å</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡∏Å‡∏§‡∏ï</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏•‡∏≠‡∏î</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏´‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ß‡∏¥‡∏™‡∏±‡∏ç‡∏ç‡∏µ</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠</option>
        <option>‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏û‡∏¥‡πÄ‡∏®‡∏©</option>
        <option>‡∏á‡∏≤‡∏ô‡∏õ‡∏ê‡∏°‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
      </select>
    </div>

    <!-- ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç + ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ -->
    <div class="col-md-3">
      <label class="form-label">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
      <input type="number" name="priority" class="form-control" min="1" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
      <select name="nature" class="form-select" required>
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
        <option>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏î‡πÅ‡∏ó‡∏ô</option>
        <option>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</option>
      </select>
    </div>

    <!-- ‡∏£‡∏´‡∏±‡∏™ + ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
    <div class="col-md-3">
      <label class="form-label">‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
      <input type="text" name="code" class="form-control">
    </div>
    <div class="col-md-9">
      <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
      <input type="text" name="itemName" class="form-control" required>
    </div>

    <!-- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô + ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö -->
    <div class="col-md-3">
      <label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
      <input type="number" name="quantity" class="form-control" min="1" required>
    </div>
    <div class="col-md-3">
      <label class="form-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö</label>
      <input type="text" name="unit" class="form-control" required>
      <small class="text-muted">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</small>
    </div>

    <!-- ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå + ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå (‡∏£‡∏ß‡∏° VAT) -->
    <div class="col-md-3">
      <label class="form-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
      <select name="priceType" class="form-select">
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
        <option>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ 1 ‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ</option>
        <option>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó</option>
      </select>
    </div>
    <div class="col-md-3">
      <label class="form-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå (‡∏£‡∏ß‡∏° VAT)</label>
      <input type="number" name="priceVat" class="form-control" min="10000" step="100" required>
      <small class="text-muted">
        ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡∏¥‡∏ô 10,000 ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏¢/‡∏™‡∏¥‡∏ö/‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÄ‡∏ä‡πà‡∏ô 11,000
      </small>
    </div>

    <!-- ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• -->
    <div class="col-12">
      <label class="form-label">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</label>
      <textarea name="reason" class="form-control" rows="3" minlength="20" maxlength="500" required></textarea>
      <small class="text-muted">
        ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 20 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 500 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
      </small>
    </div>

    <!-- ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö -->
    <div class="col-md-6">
      <label class="form-label">‡πÑ‡∏ü‡∏•‡πå‡∏™‡πÄ‡∏õ‡∏Ñ/‡∏Ñ‡∏∏‡∏ì‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏â‡∏û‡∏≤‡∏∞ (Word .doc/.docx)</label>
      <input type="file" name="specFile" accept=".doc,.docx" class="form-control" required>
      <small class="text-muted">
        ‡∏´‡πâ‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ / ‡∏£‡∏∏‡πà‡∏ô / ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏•‡πá‡∏≠‡∏Ñ‡∏™‡πÄ‡∏õ‡∏Ñ
      </small>
    </div>

    <div class="col-md-6">
      <label class="form-label">‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ (PDF ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î)</label>
      <input type="file" name="quoteMin" accept="application/pdf" class="form-control" required>
      <small class="text-muted">
        ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ô‡∏ö‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏à‡∏≥‡∏´‡∏ô‡πà‡∏≤‡∏¢‡πÅ‡∏ó‡∏ô‡πÉ‡∏ö‡∏Ñ‡∏π‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 1 ‡πÅ‡∏•‡∏∞ 2
      </small>
    </div>

    <div class="col-md-6">
      <label class="form-label">‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏π‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 1 (PDF)</label>
      <input type="file" name="quote1" accept="application/pdf" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏Ñ‡∏π‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 1</label>
      <input type="number" name="quote1Price" class="form-control" min="0" step="100">
    </div>

    <div class="col-md-6">
      <label class="form-label">‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ñ‡∏π‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2 (PDF)</label>
      <input type="file" name="quote2" accept="application/pdf" class="form-control">
    </div>
    <div class="col-md-3">
      <label class="form-label">‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏Ñ‡∏π‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2</label>
      <input type="number" name="quote2Price" class="form-control" min="0" step="100">
    </div>

    <div class="col-md-6">
      <label class="form-label">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (PDF ‡∏´‡∏£‡∏∑‡∏≠ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û)</label>
      <input type="file" name="imageFile" accept="application/pdf,image/*" class="form-control">
    </div>

  </div>

  <button class="btn btn-primary mt-3" type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>
</form>

<hr class="my-4">

<h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h4>
<div id="requestTable"></div>

<hr>

<div class="d-flex justify-content-end">
  <button class="btn btn-dark" id="adminBtn">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</button>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbxP7K2YVj602t3PPZ7yAsuo94rlKxprbEtDRxwm1nxLf0ZvTmG13QzYBRCzgNjGsDiBWw/exec";

/*********** ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô Base64 ***********/
function encodeFile(file) {
  return new Promise((resolve) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result.split(",")[1]);
    reader.readAsDataURL(file);
  });
}

/*********** ‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏ö‡∏ö POST ***********/
document.getElementById("reqForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const form = e.target;
  const formData = new FormData(form);

  // ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 20 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
  const reason = form.reason.value.trim();
  if (reason.length < 20) {
    Swal.fire("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•", "‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 20 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£", "warning");
    return;
  }

  // ‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö ‚Üí Base64
  for (let field of ["specFile", "quoteMin", "quote1", "quote2", "imageFile"]) {
    let file = form[field]?.files[0];
    if (file) {
      const base64 = await encodeFile(file);
      formData.set(field, base64);
      formData.set(field + "_name", file.name);
      formData.set(field + "_type", file.type);
    }
  }

  Swal.fire({title:"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...", didOpen:()=>Swal.showLoading()});

  let res = await fetch(API, { method: "POST", body: formData });
  let json = await res.json();

  Swal.close();

  if (json.success) {
    Swal.fire("‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢", "success");
    loadRequests();
  } else {
    Swal.fire("‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", json.message, "error");
  }
});

/*********** ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠ ***********/
async function loadRequests() {
  const url = API + "?action=listRequests&sheetId=19HF10SiHNtUyT9ikq5TriUJO6KkK_y7OTS12W-2Xmck";
  const res = await fetch(url);
  const json = await res.json();
  showTable(json.data);
}

function showTable(rows) {
  let html = `
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠</th>
        <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
        <th>‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</th>
      </tr>
    </thead>
    <tbody>
  `;

  rows.forEach((r, idx) => {
    html += `
      <tr>
        <td>${r.fullname}</td>
        <td>${r.itemName}</td>
        <td>${r.quantity}</td>
        <td>${r.status || ""}</td>
        <td>${r.note || ""}</td>
        <td>
          <span class="file-icons d-flex gap-2">
            <a href="${r.spec}" target="_blank" title="‡∏™‡πÄ‡∏õ‡∏Ñ">üìÑ</a>
            <a href="${r.quoteMin}" target="_blank" title="‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤">üí∞</a>
            <a href="${r.quote1}" target="_blank" title="‡∏Ñ‡∏π‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 1">üìë</a>
            <a href="${r.quote2}" target="_blank" title="‡∏Ñ‡∏π‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2">üìë</a>
          </span>
        </td>
      </tr>
    `;
  });

  html += "</tbody></table>";
  document.getElementById("requestTable").innerHTML = html;
}


loadRequests();

/*********** Admin Login (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) ***********/
document.getElementById("adminBtn").onclick = async () => {
  const { value: login } = await Swal.fire({
    title: "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà",
    html: `
      <input id="user" class="swal2-input" placeholder="Username">
      <input id="pass" class="swal2-input" type="password" placeholder="Password">
    `,
    preConfirm: () => ({
      user: document.getElementById("user").value,
      pass: document.getElementById("pass").value
    })
  });

  if (!login) return;

  if (login.user === "admin1" && login.pass === "planuph334") {
    Swal.fire("‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß", "success");
    adminPanel();
  } else {
    Swal.fire("‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", "error");
  }
};

async function adminPanel() {
  const url = API + "?action=listRequests&sheetId=19HF10SiHNtUyT9ikq5TriUJO6KkK_y7OTS12W-2Xmck";
  const res = await fetch(url);
  const json = await res.json();

  let html = `
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
        <th>‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</th>
      </tr>
    </thead>
    <tbody>
  `;

  json.data.forEach((r, idx) => {
    html += `
      <tr>
        <td>${idx}</td>
        <td>${r.fullname}</td>
        <td>${r.itemName}</td>
        <td>${r.status}</td>
        <td>
          <span class="file-icons d-flex gap-2">
            <a href="${r.spec}" target="_blank">üìÑ</a>
            <a href="${r.quoteMin}" target="_blank">üí∞</a>
            <a href="${r.quote1}" target="_blank">üìë</a>
            <a href="${r.quote2}" target="_blank">üìë</a>
          </span>
        </td>
      </tr>
    `;
  });

  html += "</tbody></table>";

  Swal.fire({
    title: "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",
    width: "900px",
    html: html
  });
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>