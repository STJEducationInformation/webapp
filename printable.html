<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>เอกสารคำขอครุภัณฑ์ (สำหรับพิมพ์)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: "Kanit", sans-serif;
      margin: 30px;
      color: #111;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    .section-title {
      margin-top: 20px;
      font-weight: 600;
      font-size: 18px;
      border-bottom: 2px solid #555;
      padding-bottom: 4px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
      font-size: 15px;
    }

    table td {
      padding: 6px 8px;
      border: 1px solid #ccc;
      vertical-align: top;
    }

    .label {
      width: 28%;
      background: #f3f4f6;
      font-weight: 600;
    }

    .print-btn {
      margin-top: 20px;
      padding: 10px 16px;
      background: #4f46e5;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      font-size: 15px;
      border: none;
    }

    .hidden {
      display: none;
    }
  </style>

  <script>
    // ดึงข้อมูลที่ Apps Script ส่งเข้ามา
    function loadData() {
      const params = new URLSearchParams(window.location.search);
      const jsonData = params.get("data");

      if (!jsonData) return;

      const obj = JSON.parse(decodeURIComponent(jsonData));

      for (const key in obj) {
        const el = document.getElementById(key);
        if (el) el.textContent = obj[key];
      }
    }

    function printPage() {
      document.getElementById("printButton").classList.add("hidden");
      window.print();
    }

    window.onload = loadData;
  </script>
</head>

<body>

  <button id="printButton" class="print-btn" onclick="printPage()">พิมพ์เอกสาร</button>

  <h2>เอกสารคำขออนุมัติจัดซื้อครุภัณฑ์</h2>

  <div class="section-title">ข้อมูลผู้ขอ</div>

  <table>
    <tr>
      <td class="label">วันที่</td>
      <td id="date"></td>
    </tr>
    <tr>
      <td class="label">ชื่อ-สกุล</td>
      <td id="fullName"></td>
    </tr>
    <tr>
      <td class="label">ตำแหน่ง</td>
      <td id="position"></td>
    </tr>
    <tr>
      <td class="label">หน่วยงาน</td>
      <td id="department"></td>
    </tr>
    <tr>
      <td class="label">E-mail</td>
      <td id="email"></td>
    </tr>
  </table>

  <div class="section-title">ข้อมูลครุภัณฑ์</div>

  <table>
    <tr>
      <td class="label">ชื่อรายการครุภัณฑ์</td>
      <td id="assetName"></td>
    </tr>
    <tr>
      <td class="label">จำนวน</td>
      <td id="quantity"></td>
    </tr>
    <tr>
      <td class="label">หน่วยนับ</td>
      <td id="unit"></td>
    </tr>
    <tr>
      <td class="label">รหัสครุภัณฑ์</td>
      <td id="assetCode"></td>
    </tr>
    <tr>
      <td class="label">ลักษณะครุภัณฑ์</td>
      <td id="assetNature"></td>
    </tr>
    <tr>
      <td class="label">ประเภทครุภัณฑ์</td>
      <td id="assetType"></td>
    </tr>
    <tr>
      <td class="label">ลำดับความสำคัญ</td>
      <td id="priority"></td>
    </tr>
    <tr>
      <td class="label">ราคา (รวม VAT)</td>
      <td id="priceWithVat"></td>
    </tr>
  </table>

  <div class="section-title">เหตุผลความจำเป็น</div>

  <table>
    <tr>
      <td id="reason"></td>
    </tr>
  </table>

  <div class="section-title">สถานะคำขอ</div>

  <table>
    <tr>
      <td class="label">สถานะปัจจุบัน</td>
      <td id="status"></td>
    </tr>
    <tr>
      <td class="label">เหตุผลการไม่อนุมัติ (ถ้ามี)</td>
      <td id="rejectReason"></td>
    </tr>
  </table>

</body>
</html>
