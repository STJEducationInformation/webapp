<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡πÉ‡∏ö‡∏Ç‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  .file-icons a { font-size: 24px; margin-right: 10px; }
</style>

</head>
<body class="p-4">

<h3>‡πÉ‡∏ö‡∏Ç‡∏≠‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</h3>
<hr>

<div id="content">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbztkOFDCGLsW1Albzxn1nshbs_UnqzZaL1G5LiWD-vF2zmpglAhmBCpjjXVBjJYA4BtZw/exec";
const params = new URLSearchParams(location.search);
const idx = Number(params.get("index"));

async function load() {
  const url = API + "?action=listRequests&sheetId=19HF10SiHNtUyT9ikq5TriUJO6KkK_y7OTS12W-2Xmck";
  const res = await fetch(url);
  const json = await res.json();

  const r = json.data[idx];
  if (!r) {
    document.getElementById("content").innerHTML = "<div class='alert alert-danger'>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>";
    return;
  }

  document.getElementById("content").innerHTML = `
    <p><b>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≠:</b> ${r.fullname}</p>
    <p><b>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</b> ${r.itemName}</p>
    <p><b>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</b> ${r.quantity}</p>

    <h5 class="mt-4">‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö</h5>
    <div class="file-icons">
      <a href="${r.spec}" target="_blank">üìÑ</a>
      <a href="${r.quoteMin}" target="_blank">üí∞</a>
      <a href="${r.quote1}" target="_blank">üìë</a>
      <a href="${r.quote2}" target="_blank">üìë</a>
    </div>
  `;
}

load();
</script>

</body>
</html>
